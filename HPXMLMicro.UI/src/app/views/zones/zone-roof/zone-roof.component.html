<div class="container">
  <div
    class="rounded-3 border-danger px-lg-4 px-md-3 py-3 p-2 my-lg-5 my-md-3 my-2 error-box"
    *ngIf="errorList.length != 0"
  >
    <h5
      class="text-danger my-lg-3 my-2"
      *ngFor="let errorMsg of errorList; let i = index"
    >
      {{ i + 1 + ")   " + errorMsg }}
    </h5>
  </div>
  <h3 class="col-12 mt-4 mb-lg-4 mb-md-2 d-flex justify-content-between">
    Attics &nbsp;&nbsp;
    <button
      class="ms-2 icon-btn"
      (click)="addToFormArray(this.atticsObj, this.atticInputs(), 100)"
    >
      <img src="/assets/icons/plus.svg" width="30px" alt="" />
    </button>
  </h3>
  <form [formGroup]="atticForm">
    <ng-container formArrayName="attics">
      <ng-container
        *ngFor="let atticItem of atticsObj?.controls; let atticIndex = index"
      >
        <div
          [formGroupName]="atticIndex"
          class="row px-0 mx-0 mb-2 border px-1 pt-3 rounded-3 mb-3"
        >
          <div class="col-12 d-flex">
            <h5 class="mb-0">Attic ({{ atticIndex + 1 }})</h5>
            <button
              class="ms-2 icon-btn"
              (click)="removeFromFormArray(atticsObj, atticIndex, 1)"
            >
              <img src="/assets/icons/delete.svg" alt="" />
            </button>
          </div>
          <div class="row px-0 mx-0">
            <div class="col-md-6">
              <div class="input-box">
                <label class="required"> Attic name </label>
                <input
                  formControlName="atticName"
                  type="text"
                  id="atticName"
                  placeholder="Attic name"
                />
                <div
                  class="errormsg"
                  *ngIf="
                    (atticItem.get('atticName')?.touched ||
                      atticItem.get('atticName')?.dirty) &&
                    atticItem.get('atticName')?.invalid
                  "
                >
                  <label
                    class="text-danger fw-semibold position-absolute"
                    *ngIf="atticItem.get('atticName')?.errors?.['required']"
                  >
                    Attic name is invalid
                  </label>
                  <label
                    class="text-danger fw-semibold position-absolute"
                    *ngIf="!atticItem.get('atticName')?.errors?.['required'] && atticItem.get('atticName')?.errors?.['nameSame']"
                  >
                    Attic name must be unique.
                  </label>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="select-box">
                <label class="required"> Attic Type </label>
                <ng-select
                  [items]="AtticTypeOptions"
                  bindLabel="name"
                  [clearable]="true"
                  [closeOnSelect]="true"
                  bindValue="value"
                  placeholder="Attic Type"
                  id="atticType"
                  formControlName="atticType"
                >
                </ng-select>
                <div
                  class="errormsg"
                  *ngIf="
                    (atticItem.get('atticType')?.touched ||
                      atticItem.get('atticType')?.dirty) &&
                    atticItem.get('atticType')?.invalid
                  "
                >
                  <label class="text-danger fw-semibold position-absolute">
                    Attic is invalid
                  </label>
                </div>
              </div>
            </div>
            <ng-container formArrayName="atticTypeDynamicOptions">
              <ng-container
                *ngFor="
                  let atticDynamic of atticTypeDynamicOptionsObj(atticIndex)
                    ?.controls;
                  let atticTypeDynamicOptionsIndex = index
                "
              >
                <ng-container [formGroupName]="atticTypeDynamicOptionsIndex">
                  <div class="col-md-6">
                    <div class="select-box">
                      <label> Attic Status for Vented </label>
                      <ng-select
                        [items]="BooleanOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Vented or not"
                        id="radiantBarrier"
                        formControlName="vented"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (atticDynamic.get('vented')?.touched ||
                            atticDynamic.get('vented')?.dirty) &&
                          atticDynamic.get('vented')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Vented status is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label> Attic Status for Conditioned </label>
                      <ng-select
                        [items]="BooleanOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Conditioned or not"
                        id="conditioned"
                        formControlName="conditioned"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (atticDynamic.get('conditioned')?.touched ||
                            atticDynamic.get('conditioned')?.dirty) &&
                          atticDynamic.get('conditioned')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Conditioned status is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label> Attic Status for CapeCod </label>
                      <ng-select
                        [items]="BooleanOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="CapeCod or not"
                        id="radiantBarrier"
                        formControlName="capeCod"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (atticDynamic.get('capeCod')?.touched ||
                            atticDynamic.get('capeCod')?.dirty) &&
                          atticDynamic.get('capeCod')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          CapeCod status is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                </ng-container>
              </ng-container>
            </ng-container>

            <h5
              class="fw-medium col-12 mt-4 mb-lg-4 mb-md-2 d-flex justify-content-between"
              [ngClass]="{
                disable: atticItem?.get('tracker')?.value['maximumRoof'] == 0
              }"
            >
              Attached Roofs &nbsp;&nbsp;
              <button
                class="ms-2 icon-btn"
                (click)="
                  addToFormArray(
                    roofsObj(atticIndex),
                    roofInputs(),
                    atticItem?.get('tracker')?.value['maximumRoof']
                  )
                "
              >
                <img src="/assets/icons/plus.svg" width="30px" alt="" />
              </button>
            </h5>
            <ng-container formArrayName="roofs">
              <div
                *ngFor="
                  let roofItem of roofsObj(atticIndex)?.controls;
                  let roofIndex = index
                "
                class="border rounded-2 row mx-0 px-2 py-3 mb-2"
              >
                <div class="col-12 d-flex">
                  <h5 class="mb-0">Roof ({{ roofIndex + 1 }})</h5>
                  <button
                    class="ms-2 icon-btn"
                    (click)="
                      removeFromFormArray(
                        roofsObj(atticIndex),
                        roofIndex,
                        atticItem?.get('tracker')?.value['minimumRoof']
                      )
                    "
                  >
                    <img src="/assets/icons/delete.svg" alt="" />
                  </button>
                </div>
                <ng-container [formGroupName]="roofIndex">
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Roof Name </label>
                      <input
                        formControlName="roofName"
                        type="text"
                        id="roofName"
                        placeholder="Roof Name"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('roofName')?.touched ||
                            roofItem.get('roofName')?.dirty) &&
                          roofItem.get('roofName')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="roofItem.get('roofName')?.errors?.['required']"
                        >
                          Roof Name is invalid
                        </label>
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="!roofItem.get('roofName')?.errors?.['required'] && roofItem.get('roofName')?.errors?.['nameSame']"
                        >
                          Roof Name must be unique.
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label class="required"> Roof Type </label>
                      <ng-select
                        [items]="RoofTypeOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder=" Roof Type "
                        id="roofType"
                        formControlName="roofType"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('roofType')?.touched ||
                            roofItem.get('roofType')?.dirty) &&
                          roofItem.get('roofType')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Roof Type is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label> Roof Color </label>
                      <ng-select
                        [items]="RoofColorOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder=" Roof Color "
                        id="roofColor"
                        formControlName="roofColor"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('roofColor')?.touched ||
                            roofItem.get('roofColor')?.dirty) &&
                          roofItem.get('roofColor')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Roof Color is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label> Radiant Barrier </label>
                      <ng-select
                        [items]="BooleanOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Radiant Barrier"
                        id="radiantBarrier"
                        formControlName="radiantBarrier"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('radiantBarrier')?.touched ||
                            roofItem.get('radiantBarrier')?.dirty) &&
                          roofItem.get('radiantBarrier')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Radiant Barrier is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Area </label>
                      <input
                        formControlName="area"
                        type="number"
                        id="area"
                        placeholder="Area"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('area')?.touched ||
                            roofItem.get('area')?.dirty) &&
                          roofItem.get('area')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Area is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="input-box">
                      <label> Solar Absorptance </label>
                      <input
                        formControlName="solarAbsorptance"
                        type="number"
                        id="solarAbsorptance"
                        placeholder="Solar Absorptance"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (roofItem.get('solarAbsorptance')?.touched ||
                            roofItem.get('solarAbsorptance')?.dirty) &&
                          roofItem.get('solarAbsorptance')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Solar Absorptance is invalid
                        </label>
                      </div>
                    </div>
                  </div>

                  <div class="col-12 d-flex my-3">
                    <h5 class="mb-0">Roof Insulation</h5>
                  </div>
                  <div
                    formGroupName="insulation"
                    class="border rounded-2 row mx-0 px-1 pt-3 pb-1 mb-2"
                  >
                    <div class="col-md-6">
                      <div class="input-box">
                        <label>Assembly Effective R-Value </label>
                        <input
                          formControlName="assemblyEffectiveRValue"
                          type="number"
                          id="assemblyEffectiveRValue"
                          placeholder="Assembly Effective R-Value"
                        />
                        <div
                          class="errormsg"
                          *ngIf="
                            (roofInsulationObj(atticIndex, roofIndex).get(
                              'assemblyEffectiveRValue'
                            )?.touched ||
                              roofInsulationObj(atticIndex, roofIndex).get(
                                'assemblyEffectiveRValue'
                              )?.dirty) &&
                            roofInsulationObj(atticIndex, roofIndex).get(
                              'assemblyEffectiveRValue'
                            )?.invalid
                          "
                        >
                          <label
                            class="text-danger fw-semibold position-absolute"
                          >
                            Assembly Effective R-Value is invalid
                          </label>
                        </div>
                      </div>
                    </div>
                    <ng-container formArrayName="layers">
                      <div class="col-12 d-flex my-3">
                        <h5 class="mb-0">Layers</h5>
                        <button
                          class="ms-2 icon-btn"
                          (click)="
                            addToFormArray(
                              roofInsulationLayersObj(atticIndex, roofIndex),
                              layerInputs()
                            )
                          "
                        >
                          <img
                            src="/assets/icons/plus.svg"
                            width="20px"
                            alt=""
                          />
                        </button>
                      </div>
                      <div
                        *ngFor="
                          let roofInsulationLayerItem of roofInsulationLayersObj(
                            atticIndex,
                            roofIndex
                          )?.controls;
                          let roofInsulationLayerIndex = index
                        "
                        class="border rounded-2 row mx-0 px-0 pt-3 pb-1 mb-2"
                      >
                        <div class="col-12 d-flex">
                          <h5 class="mb-0">
                            Layer ({{ roofInsulationLayerIndex + 1 }})
                          </h5>
                          <button
                            class="ms-2 icon-btn"
                            (click)="
                              removeFromFormArray(
                                roofInsulationLayersObj(atticIndex, roofIndex),
                                roofInsulationLayerIndex
                              )
                            "
                          >
                            <img src="/assets/icons/delete.svg" alt="" />
                          </button>
                        </div>
                        <ng-container
                          [formGroupName]="roofInsulationLayerIndex"
                        >
                          <div class="col-md-6">
                            <div class="input-box">
                              <label> Nominal R-Value </label>
                              <input
                                formControlName="nominalRValue"
                                type="number"
                                id="nominalRValue"
                                placeholder="Nominal R-Value"
                              />
                              <div
                                class="errormsg"
                                *ngIf="
                                  (roofInsulationLayerItem.get('nominalRValue')
                                    ?.touched ||
                                    roofInsulationLayerItem.get('nominalRValue')
                                      ?.dirty) &&
                                  roofInsulationLayerItem.get('nominalRValue')
                                    ?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Nominal R-Value is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Installation Type </label>
                              <ng-select
                                [items]="installationTypeOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Installation Type"
                                id="installationType"
                                formControlName="installationType"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (roofInsulationLayerItem.get(
                                    'installationType'
                                  )?.touched ||
                                    roofInsulationLayerItem.get(
                                      'installationType'
                                    )?.dirty) &&
                                  roofInsulationLayerItem.get(
                                    'installationType'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Installation Type is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Insulation Material </label>
                              <ng-select
                                [items]="insulationMaterialOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Insulation Material"
                                id="insulationMaterial"
                                formControlName="insulationMaterial"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (roofInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.touched ||
                                    roofInsulationLayerItem.get(
                                      'insulationMaterial'
                                    )?.dirty) &&
                                  roofInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Insulation Material is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <ng-container
                            formArrayName="insulationMaterialDynamicOptions"
                          >
                            <ng-container
                              *ngFor="
                                let insulationMaterialDynamic of roofInsulationMaterialDynamicOptionsObj(
                                  atticIndex,
                                  roofIndex,
                                  roofInsulationLayerIndex
                                )?.controls;
                                let insulationMaterialDynamicIndex = index
                              "
                            >
                              <ng-container
                                [formGroupName]="insulationMaterialDynamicIndex"
                              >
                                <div class="col-md-6">
                                  <div class="select-box">
                                    <label>
                                      {{
                                        insulationMaterialDynamic.get("options")
                                          ?.value?.label
                                      }}
                                    </label>
                                    <ng-select
                                      [items]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.options
                                      "
                                      bindLabel="name"
                                      [clearable]="true"
                                      [closeOnSelect]="true"
                                      bindValue="value"
                                      [placeholder]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.placeHolder
                                      "
                                      id="radiantBarrier"
                                      [formControlName]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.name
                                      "
                                    >
                                    </ng-select>
                                    <div
                                      class="errormsg"
                                      *ngIf="
                                        (insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.touched ||
                                          insulationMaterialDynamic.get(
                                            insulationMaterialDynamic.get(
                                              'options'
                                            )?.value?.name
                                          )?.dirty) &&
                                        insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.invalid
                                      "
                                    >
                                      <label
                                        class="text-danger fw-semibold position-absolute"
                                      >
                                        {{
                                          insulationMaterialDynamic.get(
                                            "options"
                                          )?.value?.errorMsg
                                        }}
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </ng-container>
                            </ng-container>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                  </div>

                  <div class="col-12 d-flex my-3">
                    <h5 class="mb-0">Skylights</h5>
                    <button
                      class="ms-2 icon-btn"
                      (click)="
                        addToFormArray(
                          skylightsObj(atticIndex, roofIndex),
                          skylightInputs()
                        )
                      "
                    >
                      <img src="/assets/icons/plus.svg" width="20px" alt="" />
                    </button>
                  </div>
                  <ng-container formArrayName="skylights">
                    <div
                      *ngFor="
                        let skylightsItem of skylightsObj(atticIndex, roofIndex)
                          ?.controls;
                        let skylightsIndex = index
                      "
                      class="border rounded-2 row mx-0 px-0 py-3 mb-2"
                    >
                      <div class="col-12 d-flex">
                        <h5 class="mb-0">
                          Skylight ({{ skylightsIndex + 1 }})
                        </h5>
                        <button
                          class="ms-2 icon-btn"
                          (click)="
                            removeFromFormArray(
                              skylightsObj(atticIndex, roofIndex),
                              skylightsIndex
                            )
                          "
                        >
                          <img src="/assets/icons/delete.svg" alt="" />
                        </button>
                      </div>
                      <ng-container [formGroupName]="skylightsIndex">
                        <div class="col-md-6">
                          <div class="input-box">
                            <label> Area </label>
                            <input
                              formControlName="area"
                              type="number"
                              id="area"
                              placeholder="Area"
                            />
                            <div
                              class="errormsg"
                              *ngIf="
                                (skylightsItem.get('area')?.touched ||
                                  skylightsItem.get('area')?.dirty) &&
                                skylightsItem.get('area')?.invalid
                              "
                            >
                              <label
                                class="text-danger fw-semibold position-absolute"
                              >
                                Area is invalid
                              </label>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-box">
                            <label> UFactor </label>
                            <input
                              formControlName="uFactor"
                              type="number"
                              id="uFactor"
                              placeholder="UFactor"
                            />
                            <div
                              class="errormsg"
                              *ngIf="
                                (skylightsItem.get('uFactor')?.touched ||
                                  skylightsItem.get('uFactor')?.dirty) &&
                                skylightsItem.get('uFactor')?.invalid
                              "
                            >
                              <label
                                class="text-danger fw-semibold position-absolute"
                              >
                                UFactor is invalid
                              </label>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-box">
                            <label> SHGC </label>
                            <input
                              formControlName="sHGC"
                              type="number"
                              id="sHGC"
                              placeholder="SHGC"
                            />
                            <div
                              class="errormsg"
                              *ngIf="
                                (skylightsItem.get('sHGC')?.touched ||
                                  skylightsItem.get('sHGC')?.dirty) &&
                                skylightsItem.get('sHGC')?.invalid
                              "
                            >
                              <label
                                class="text-danger fw-semibold position-absolute"
                              >
                                SHGC is invalid
                              </label>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </ng-container>

            <h5
              class="fw-medium col-12 mt-4 mb-lg-4 mb-md-2 d-flex justify-content-between"
              [ngClass]="{
                disable: atticItem?.get('tracker')?.value['maximumWall'] == 0
              }"
            >
              Attached Walls &nbsp;&nbsp;
              <button
                class="ms-2 icon-btn"
                (click)="
                  addToFormArray(
                    wallsObj(atticIndex),
                    wallInputs(),
                    atticItem?.get('tracker')?.value['maximumWall']
                  )
                "
              >
                <img src="/assets/icons/plus.svg" width="30px" alt="" />
              </button>
            </h5>
            <ng-container formArrayName="walls">
              <div
                *ngFor="
                  let wallItem of wallsObj(atticIndex)?.controls;
                  let wallIndex = index
                "
                class="border rounded-2 row mx-0 px-2 py-3 mb-2"
              >
                <div class="col-12 d-flex">
                  <h5 class="mb-0">Walls({{ wallIndex + 1 }})</h5>
                  <button
                    class="ms-2 icon-btn"
                    (click)="
                      removeFromFormArray(
                        wallsObj(wallIndex),
                        wallIndex,
                        atticItem?.get('tracker')?.value['minimumWall']
                      )
                    "
                  >
                    <img src="/assets/icons/delete.svg" alt="" />
                  </button>
                </div>
                <ng-container [formGroupName]="wallIndex">
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Wall Name </label>
                      <input
                        formControlName="wallName"
                        type="text"
                        id="wallName"
                        placeholder="Wall Name"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (wallItem.get('wallName')?.touched ||
                            wallItem.get('wallName')?.dirty) &&
                          wallItem.get('wallName')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="wallItem.get('wallName')?.errors?.['required']"
                        >
                          Wall Name is invalid
                        </label>
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="!wallItem.get('wallName')?.errors?.['required'] && wallItem.get('wallName')?.errors?.['nameSame']"
                        >
                          Wall Name must be unique.
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label class="required"> Exterior Adjacent To </label>
                      <ng-select
                        [items]="ExteriorAdjacentToOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Exterior Adjacent to"
                        id="exteriorAdjacentTo"
                        formControlName="exteriorAdjacentTo"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (wallItem.get('exteriorAdjacentTo')?.touched ||
                            wallItem.get('exteriorAdjacentTo')?.dirty) &&
                          wallItem.get('exteriorAdjacentTo')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Exterior Adjacent to is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label class="required"> Interior Adjacent To </label>
                      <ng-select
                        [items]="interiorAdjacentToOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Interior Adjacent to"
                        id="interiorAdjacentTo"
                        formControlName="interiorAdjacentTo"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (wallItem.get('interiorAdjacentTo')?.touched ||
                            wallItem.get('interiorAdjacentTo')?.dirty) &&
                          wallItem.get('interiorAdjacentTo')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Interior Adjacent to is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="select-box">
                      <label class="required"> Wall Type </label>
                      <ng-select
                        [items]="atticWallTypeOptions"
                        bindLabel="name"
                        [clearable]="true"
                        [closeOnSelect]="true"
                        bindValue="value"
                        placeholder="Attic Wall Type"
                        id="atticWallType"
                        formControlName="atticWallType"
                      >
                      </ng-select>
                      <div
                        class="errormsg"
                        *ngIf="
                          (atticItem.get('atticWallType')?.touched ||
                            atticItem.get('atticWallType')?.dirty) &&
                          atticItem.get('atticWallType')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Wall Type is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Area </label>
                      <input
                        formControlName="area"
                        type="number"
                        id="area"
                        placeholder="Area"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (wallItem.get('area')?.touched ||
                            wallItem.get('area')?.dirty) &&
                          wallItem.get('area')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Area is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div
                    formGroupName="insulation"
                    class="border rounded-2 row mx-0 px-1 py-3 mb-2"
                  >
                    <div class="col-12 d-flex mt-2 mb-1">
                      <h5 class="mb-0">Wall Insulation</h5>
                    </div>
                    <div class="col-md-6">
                      <div class="input-box">
                        <label>Assembly Effective R-Value </label>
                        <input
                          formControlName="assemblyEffectiveRValue"
                          type="number"
                          id="assemblyEffectiveRValue"
                          placeholder="Assembly Effective R-Value"
                        />
                        <div
                          class="errormsg"
                          *ngIf="
                            (wallInsulationObj(atticIndex, wallIndex).get(
                              'assemblyEffectiveRValue'
                            )?.touched ||
                              wallInsulationObj(atticIndex, wallIndex).get(
                                'assemblyEffectiveRValue'
                              )?.dirty) &&
                            wallInsulationObj(atticIndex, wallIndex).get(
                              'assemblyEffectiveRValue'
                            )?.invalid
                          "
                        >
                          <label
                            class="text-danger fw-semibold position-absolute"
                          >
                            Assembly Effective R-Value is invalid
                          </label>
                        </div>
                      </div>
                    </div>
                    <ng-container formArrayName="layers">
                      <div class="col-12 d-flex my-3">
                        <h5 class="mb-0">Layers</h5>
                        <button
                          class="ms-2 icon-btn"
                          (click)="
                            addToFormArray(
                              wallInsulationLayersObj(atticIndex, wallIndex),
                              layerInputs()
                            )
                          "
                        >
                          <img
                            src="/assets/icons/plus.svg"
                            width="20px"
                            alt=""
                          />
                        </button>
                      </div>
                      <div
                        *ngFor="
                          let wallInsulationLayerItem of wallInsulationLayersObj(
                            atticIndex,
                            wallIndex
                          )?.controls;
                          let wallInsulationLayerIndex = index
                        "
                        class="border rounded-2 row mx-0 px-0 py-3 mb-2"
                      >
                        <div class="col-12 d-flex">
                          <h5 class="mb-0">
                            Layer ({{ wallInsulationLayerIndex + 1 }})
                          </h5>
                          <button
                            class="ms-2 icon-btn"
                            (click)="
                              removeFromFormArray(
                                wallInsulationLayersObj(atticIndex, wallIndex),
                                wallInsulationLayerIndex
                              )
                            "
                          >
                            <img src="/assets/icons/delete.svg" alt="" />
                          </button>
                        </div>
                        <ng-container
                          [formGroupName]="wallInsulationLayerIndex"
                        >
                          <div class="col-md-6">
                            <div class="input-box">
                              <label> Nominal R-Value </label>
                              <input
                                formControlName="nominalRValue"
                                type="number"
                                id="nominalRValue"
                                placeholder="Nominal R-Value"
                              />
                              <div
                                class="errormsg"
                                *ngIf="
                                  (wallInsulationLayerItem.get('nominalRValue')
                                    ?.touched ||
                                    wallInsulationLayerItem.get('nominalRValue')
                                      ?.dirty) &&
                                  wallInsulationLayerItem.get('nominalRValue')
                                    ?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Nominal R-Value is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Installation Type </label>
                              <ng-select
                                [items]="installationTypeOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Installation Type"
                                id="installationType"
                                formControlName="installationType"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (wallInsulationLayerItem.get(
                                    'installationType'
                                  )?.touched ||
                                    wallInsulationLayerItem.get(
                                      'installationType'
                                    )?.dirty) &&
                                  wallInsulationLayerItem.get(
                                    'installationType'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Installation Type is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Insulation Material </label>
                              <ng-select
                                [items]="insulationMaterialOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Insulation Material"
                                id="insulationMaterial"
                                formControlName="insulationMaterial"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (wallInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.touched ||
                                    wallInsulationLayerItem.get(
                                      'insulationMaterial'
                                    )?.dirty) &&
                                  wallInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Insulation Material is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <ng-container
                            formArrayName="insulationMaterialDynamicOptions"
                          >
                            <ng-container
                              *ngFor="
                                let insulationMaterialDynamic of wallInsulationMaterialDynamicOptionsObj(
                                  atticIndex,
                                  wallIndex,
                                  wallInsulationLayerIndex
                                )?.controls;
                                let insulationMaterialDynamicIndex = index
                              "
                            >
                              <ng-container
                                [formGroupName]="insulationMaterialDynamicIndex"
                              >
                                <div class="col-md-6">
                                  <div class="select-box">
                                    <label>
                                      {{
                                        insulationMaterialDynamic.get("options")
                                          ?.value?.label
                                      }}
                                    </label>
                                    <ng-select
                                      [items]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.options
                                      "
                                      bindLabel="name"
                                      [clearable]="true"
                                      [closeOnSelect]="true"
                                      bindValue="value"
                                      [placeholder]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.placeHolder
                                      "
                                      id="radiantBarrier"
                                      [formControlName]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.name
                                      "
                                    >
                                    </ng-select>
                                    <div
                                      class="errormsg"
                                      *ngIf="
                                        (insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.touched ||
                                          insulationMaterialDynamic.get(
                                            insulationMaterialDynamic.get(
                                              'options'
                                            )?.value?.name
                                          )?.dirty) &&
                                        insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.invalid
                                      "
                                    >
                                      <label
                                        class="text-danger fw-semibold position-absolute"
                                      >
                                        {{
                                          insulationMaterialDynamic.get(
                                            "options"
                                          )?.value?.errorMsg
                                        }}
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </ng-container>
                            </ng-container>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
              </div>
            </ng-container>

            <h5
              class="fw-medium col-12 mt-4 mb-lg-4 mb-md-2 d-flex justify-content-between"
              [ngClass]="{
                disable:
                  atticItem?.get('tracker')?.value['maximumFrameFloor'] == 0
              }"
            >
              Attached Frame Floors &nbsp;&nbsp;
              <button
                class="ms-2 icon-btn"
                (click)="
                  addToFormArray(
                    frameFloorsObj(atticIndex),
                    frameFloorInput(),
                    atticItem?.get('tracker')?.value['maximumFrameFloor']
                  )
                "
              >
                <img src="/assets/icons/plus.svg" width="30px" alt="" />
              </button>
            </h5>
            <ng-container formArrayName="frameFloors">
              <div
                *ngFor="
                  let frameFloorItem of frameFloorsObj(atticIndex)?.controls;
                  let frameFloorIndex = index
                "
                class="border rounded-2 row mx-0 px-2 pt-3 pb-1 mb-2"
              >
                <div class="col-12 d-flex">
                  <h5 class="mb-0">Frame Floor({{ frameFloorIndex + 1 }})</h5>
                  <button
                    class="ms-2 icon-btn"
                    (click)="
                      removeFromFormArray(
                        frameFloorsObj(atticIndex),
                        frameFloorIndex,
                        atticItem?.get('tracker')?.value['minimumFrameFloor']
                      )
                    "
                  >
                    <img src="/assets/icons/delete.svg" alt="" />
                  </button>
                </div>
                <ng-container [formGroupName]="frameFloorIndex">
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Frame Floor Name </label>
                      <input
                        formControlName="frameFloorName"
                        type="text"
                        id="frameFloorName"
                        placeholder="Frame Floor Name"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (frameFloorItem.get('frameFloorName')?.touched ||
                            frameFloorItem.get('frameFloorName')?.dirty) &&
                          frameFloorItem.get('frameFloorName')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="frameFloorItem.get('frameFloorName')?.errors?.['required']"
                        >
                          Frame Floor is invalid
                        </label>
                        <label
                          class="text-danger fw-semibold position-absolute"
                          *ngIf="!frameFloorItem.get('frameFloorName')?.errors?.['required'] && frameFloorItem.get('frameFloorName')?.errors?.['nameSame']"
                        >
                          Frame Floor name must be unique.
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="input-box">
                      <label class="required"> Area </label>
                      <input
                        formControlName="area"
                        type="number"
                        id="area"
                        placeholder="Area"
                      />
                      <div
                        class="errormsg"
                        *ngIf="
                          (frameFloorItem.get('area')?.touched ||
                            frameFloorItem.get('area')?.dirty) &&
                          frameFloorItem.get('area')?.invalid
                        "
                      >
                        <label
                          class="text-danger fw-semibold position-absolute"
                        >
                          Area is invalid
                        </label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 d-flex my-3">
                    <h5 class="mb-0">Frame Floor Insulation</h5>
                  </div>
                  <div
                    formGroupName="insulation"
                    class="border rounded-2 row mx-0 px-1 pt-3 pb-1 mb-2"
                  >
                    <div class="col-md-6">
                      <div class="input-box">
                        <label>Assembly Effective R-Value </label>
                        <input
                          formControlName="assemblyEffectiveRValue"
                          type="number"
                          id="assemblyEffectiveRValue"
                          placeholder="Assembly Effective R-Value"
                        />
                        <div
                          class="errormsg"
                          *ngIf="
                            (frameFloorInsulationObj(
                              atticIndex,
                              frameFloorIndex
                            ).get('assemblyEffectiveRValue')?.touched ||
                              frameFloorInsulationObj(
                                atticIndex,
                                frameFloorIndex
                              ).get('assemblyEffectiveRValue')?.dirty) &&
                            frameFloorInsulationObj(
                              atticIndex,
                              frameFloorIndex
                            ).get('assemblyEffectiveRValue')?.invalid
                          "
                        >
                          <label
                            class="text-danger fw-semibold position-absolute"
                          >
                            Assembly Effective R-Value is invalid
                          </label>
                        </div>
                      </div>
                    </div>
                    <ng-container formArrayName="layers">
                      <div class="col-12 d-flex my-3">
                        <h5 class="mb-0">Layers</h5>
                        <button
                          class="ms-2 icon-btn"
                          (click)="
                            addToFormArray(
                              frameFloorInsulationLayersObj(
                                atticIndex,
                                frameFloorIndex
                              ),
                              layerInputs()
                            )
                          "
                        >
                          <img
                            src="/assets/icons/plus.svg"
                            width="20px"
                            alt=""
                          />
                        </button>
                      </div>
                      <div
                        *ngFor="
                          let frameFloorInsulationLayerItem of frameFloorInsulationLayersObj(
                            atticIndex,
                            frameFloorIndex
                          )?.controls;
                          let frameFloorInsulationLayerIndex = index
                        "
                        class="border rounded-2 row mx-0 px-0 pt-3 pb-1 mb-2"
                      >
                        <div class="col-12 d-flex">
                          <h5 class="mb-0">
                            Layer ({{ frameFloorInsulationLayerIndex + 1 }})
                          </h5>
                          <button
                            class="ms-2 icon-btn"
                            (click)="
                              removeFromFormArray(
                                frameFloorInsulationLayersObj(
                                  atticIndex,
                                  frameFloorIndex
                                ),
                                frameFloorInsulationLayerIndex
                              )
                            "
                          >
                            <img src="/assets/icons/delete.svg" alt="" />
                          </button>
                        </div>
                        <ng-container
                          [formGroupName]="frameFloorInsulationLayerIndex"
                        >
                          <div class="col-md-6">
                            <div class="input-box">
                              <label> Nominal R-Value </label>
                              <input
                                formControlName="nominalRValue"
                                type="number"
                                id="nominalRValue"
                                placeholder="Nominal R-Value"
                              />
                              <div
                                class="errormsg"
                                *ngIf="
                                  (frameFloorInsulationLayerItem.get(
                                    'nominalRValue'
                                  )?.touched ||
                                    frameFloorInsulationLayerItem.get(
                                      'nominalRValue'
                                    )?.dirty) &&
                                  frameFloorInsulationLayerItem.get(
                                    'nominalRValue'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Nominal R-Value is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Installation Type </label>
                              <ng-select
                                [items]="installationTypeOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Installation Type"
                                id="installationType"
                                formControlName="installationType"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (frameFloorInsulationLayerItem.get(
                                    'installationType'
                                  )?.touched ||
                                    frameFloorInsulationLayerItem.get(
                                      'installationType'
                                    )?.dirty) &&
                                  frameFloorInsulationLayerItem.get(
                                    'installationType'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Installation Type is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="select-box">
                              <label> Insulation Material </label>
                              <ng-select
                                [items]="insulationMaterialOptions"
                                bindLabel="name"
                                [clearable]="true"
                                [closeOnSelect]="true"
                                bindValue="value"
                                placeholder="Insulation Material"
                                id="insulationMaterial"
                                formControlName="insulationMaterial"
                              >
                              </ng-select>
                              <div
                                class="errormsg"
                                *ngIf="
                                  (frameFloorInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.touched ||
                                    frameFloorInsulationLayerItem.get(
                                      'insulationMaterial'
                                    )?.dirty) &&
                                  frameFloorInsulationLayerItem.get(
                                    'insulationMaterial'
                                  )?.invalid
                                "
                              >
                                <label
                                  class="text-danger fw-semibold position-absolute"
                                >
                                  Insulation Material is invalid
                                </label>
                              </div>
                            </div>
                          </div>
                          <ng-container
                            formArrayName="insulationMaterialDynamicOptions"
                          >
                            <ng-container
                              *ngFor="
                                let insulationMaterialDynamic of frameFloorInsulationMaterialDynamicOptionsObj(
                                  atticIndex,
                                  frameFloorIndex,
                                  frameFloorInsulationLayerIndex
                                )?.controls;
                                let insulationMaterialDynamicIndex = index
                              "
                            >
                              <ng-container
                                [formGroupName]="insulationMaterialDynamicIndex"
                              >
                                <div class="col-md-6">
                                  <div class="select-box">
                                    <label>
                                      {{
                                        insulationMaterialDynamic.get("options")
                                          ?.value?.label
                                      }}
                                    </label>
                                    <ng-select
                                      [items]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.options
                                      "
                                      bindLabel="name"
                                      [clearable]="true"
                                      [closeOnSelect]="true"
                                      bindValue="value"
                                      [placeholder]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.placeHolder
                                      "
                                      id="radiantBarrier"
                                      [formControlName]="
                                        insulationMaterialDynamic.get('options')
                                          ?.value?.name
                                      "
                                    >
                                    </ng-select>
                                    <div
                                      class="errormsg"
                                      *ngIf="
                                        (insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.touched ||
                                          insulationMaterialDynamic.get(
                                            insulationMaterialDynamic.get(
                                              'options'
                                            )?.value?.name
                                          )?.dirty) &&
                                        insulationMaterialDynamic.get(
                                          insulationMaterialDynamic.get(
                                            'options'
                                          )?.value?.name
                                        )?.invalid
                                      "
                                    >
                                      <label
                                        class="text-danger fw-semibold position-absolute"
                                      >
                                        {{
                                          insulationMaterialDynamic.get(
                                            "options"
                                          )?.value?.errorMsg
                                        }}
                                      </label>
                                    </div>
                                  </div>
                                </div>
                              </ng-container>
                            </ng-container>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
              </div>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </form>
  <div class="d-flex justify-content-end gap-3 my-5">
    <button class="bg-primary btn-style" (click)="onSubmit()">Submit</button>
    <button class="bg-secondary btn-style" (click)="goNext()">
      <!-- [disabled]="!enableNext" -->
      Next
    </button>
  </div>
  <div class="generate-section">
    <button
      class="d-block btn-style mx-auto bg-success my-5"
      (click)="generateHPXML()"
    >
      Generate HPXML
    </button>
    <p class="overflow-x-auto">{{ hpxmlString }}</p>
    <button
      class="d-block btn-style mx-auto bg-success my-5"
      *ngIf="hpxmlString"
      (click)="validateHPXML()"
    >
      Validate HPXML
    </button>
    <div
      class="overflow-x-auto border rounded-xl-4 rounded-md-3 rounded-2 p-xl-5 p-lg-4 p-md-3 p-2 mb-4"
      *ngIf="validationMsg"
      style="background-color: rgba(0, 0, 0, 0.089)"
    >
      <ngx-json-viewer [json]="validationMsg"></ngx-json-viewer>
    </div>
  </div>
</div>
